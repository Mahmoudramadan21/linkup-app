/*
 * =============================================================================
 *  flicks.module.css
 * =============================================================================
 *
 * Complete styling for Flicks (Reels / Shorts clone) – vertical full-screen video feed
 *
 * Features:
 *   • True vertical snap scrolling (TikTok-style)
 *   • Full-screen video with 9:16 aspect ratio on mobile
 *   • Beautiful gradient overlay + backdrop-blur action buttons
 *   • Slide-up comment modal with smooth animation
 *   • Mute/unmute + play/pause controls
 *   • Like, comment, share, save, report actions column
 *   • Full dark mode, high contrast, WCAG 2.1 AA compliance
 *   • Respects prefers-reduced-motion
 *   • Mobile-first with elegant desktop adaptation
 *   • GPU-accelerated & performance optimized
 */

@tailwind components;
@tailwind utilities;

/* ==========================================================================
   Accessibility – Disable heavy animations for reduced motion users
   ========================================================================== */
@media (prefers-reduced-motion: reduce) {
  .flicks__menu,
  .flicks__comment-modal,
  .flicks__comment-form {
    animation: none !important;
  }
}

/* ==========================================================================
   Main Layout – Full viewport vertical scroller
   ========================================================================== */
.flicks {
  @apply relative bg-[var(--app-bg)] text-[var(--text-primary)];
}

/* Snap scrolling container */
.flicks__wrapper {
  @apply snap-y snap-mandatory h-[calc(100vh-4rem)] overflow-y-auto scroll-smooth scrollbar-hidden;
}

/* Each individual flick (centered, fixed aspect ratio) */
.flicks__container {
  @apply relative flex items-center justify-center snap-center mx-auto w-full max-w-[380px] 
         rounded-2xl pb-8 aspect-[9/16];
  height: calc(100vh - 4rem);
}

/* Video element */
.flicks__video {
  @apply w-full h-full object-contain bg-black rounded-2xl;
}

/* Gradient overlay (bottom dark fade for text readability) */
.flicks__overlay {
  @apply absolute inset-0 bg-gradient-to-b from-transparent via-transparent 
         to-[rgba(var(--app-bg-rgb),0.8)] pointer-events-none;
}
.flicks__overlay > * {
  @apply pointer-events-auto;
}

/* ==========================================================================
   User Info & Caption (bottom left)
   ========================================================================== */
.flicks__info {
  @apply absolute bottom-12 left-4 right-4 z-10;
}

.flicks__user {
  @apply flex w-fit items-center gap-3 rounded-full p-2 pr-3;
}

.flicks__user-avatar {
  @apply avatar--md border-2 border-[var(--border-color)];
}

.flicks__user-username {
  @apply text-secondary font-semibold truncate max-w-[12ch] md:max-w-[auto];
}

.flicks__follow-status-button {
  @apply px-3 py-1 text-sm font-semibold border border-[var(--text-secondary)] 
         rounded-lg text-secondary;
}

.flicks__content {
  @apply text-secondary p-3 rounded-xl mt-2 w-full leading-relaxed 
         max-h-[115px] overflow-y-auto scrollbar-hidden;
}

/* ==========================================================================
   Action Buttons Column (right side)
   ========================================================================== */
.flicks__actions {
  @apply absolute -right-20 bottom-28 flex flex-col gap-6 z-10;
}

.flicks__action-button {
  @apply btn-rounded p-4 flex flex-col items-center gap-1 
         bg-[rgba(var(--card-bg-rgb),0.6)] text-[var(--text-secondary)] 
         backdrop-blur-md hover:bg-[rgba(var(--card-bg-rgb),0.8)] focus-ring;
}

.flicks__action-button--liked {
  @apply text-[var(--error)];
}

.flicks__action-button--saved {
  @apply text-[var(--linkup-purple)];
}

.flicks__action-count {
  @apply text-xs font-medium;
}

/* ==========================================================================
   More Menu (Report, Share, etc.)
   ========================================================================== */
.flicks__menu {
  @apply card absolute right-16 top-10 min-w-[120px] p-2 z-20 animate-fadeInModal;
}

.flicks__menu-item {
  @apply flex items-center gap-2 p-2 w-full text-left text-secondary 
         rounded-lg hover:bg-[var(--card-bg)] focus:bg-[rgba(var(--border-color-rgb),0.5)] 
         focus-ring transition-colors;
}

/* ==========================================================================
   Video Controls
   ========================================================================== */
.flicks__mute-button {
  @apply btn-rounded p-4 absolute top-4 right-3 
         bg-[rgba(var(--card-bg-rgb),0.6)] text-[var(--text-primary)] 
         hover:bg-[rgba(var(--card-bg-rgb),0.8)] focus-ring;
}

.flicks__play-pause-button {
  @apply btn-rounded absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 
         w-20 h-20 bg-[rgba(var(--card-bg-rgb),0.6)] hidden items-center justify-center 
         text-[var(--text-primary)] border-2 border-[rgba(var(--border-color-rgb),0.5)] 
         opacity-80 hover:opacity-100 focus-ring;
}

/* Show play/pause only on hover (desktop) */
.flicks__container:hover .flicks__play-pause-button {
  @apply flex;
}

/* ==========================================================================
   Comments Modal (Slide-up from bottom)
   ========================================================================== */
.flicks__comment-modal {
  @apply sm:max-w-[380px] m-auto fixed bottom-0 left-0 right-0 
         xl:right-[333px] h-[85vh] bg-[var(--section-bg)] rounded-t-3xl 
         z-50 shadow-2xl overflow-hidden animate-fadeInModal;
}

.flicks__comment-modal-content {
  @apply flex flex-col h-full overflow-hidden;
}

.flicks__comment-modal-header {
  @apply flex items-center justify-between p-4 border-b border-[var(--border-color)];
}

.flicks__comment-modal-title {
  @apply text-primary-bold;
}

.flicks__comment-modal-close {
  @apply text-[var(--text-secondary)] hover:text-[var(--text-primary)] 
         p-2 rounded-full focus-ring transition-colors;
}

.flicks__comment-modal-body {
  @apply flex-1 overflow-y-auto p-4 space-y-4 scrollbar-thin-purple;
}

.flicks__comment-load-more {
  @apply pt-4 text-secondary flex items-center gap-2;
}

.flicks__load-more-button {
  @apply btn-rounded--purple px-4 py-2 text-sm font-semibold;
}

/* ==========================================================================
   Comment Input Form
   ========================================================================== */
.flicks__comment-form {
  @apply flex items-center gap-3 p-4 border-t border-[var(--border-color)] 
         bg-[rgba(var(--card-bg-rgb),0.5)] animate-fadeInModal;
}

.flicks__comment-form-inner {
  @apply flex items-center gap-3 flex-1;
}

.flicks__comment-form-avatar {
  @apply avatar--md;
}

.flicks__comment-form-input {
  @apply flex-1 p-3 rounded-2xl border-none 
         bg-[rgba(var(--border-color-rgb),0.5)] text-[var(--text-primary)] 
         placeholder-[var(--text-secondary)] text-sm 
         focus:bg-[rgba(var(--border-color-rgb),0.7)] focus-ring transition-colors;
}

.flicks__comment-form-button {
  @apply btn-rounded--purple p-3 hover:scale-105 focus-ring;
}

.flicks__comment-form-button--disabled {
  @apply btn-rounded--disabled scale-100;
}

.flicks__comment-form-error {
  @apply text-secondary mt-xs ml-sm;
}

/* ==========================================================================
   Loading & Infinite Scroll
   ========================================================================== */
.flicks__load-more {
  @apply h-4;
}

.flicks__loading {
  @apply loading--lg absolute inset-0 flex items-center justify-center;
}

/* ==========================================================================
   Responsive Adjustments
   ========================================================================== */
@media (max-width: 640px) {
  .flicks__container {
    @apply max-w-none h-full aspect-auto;
  }
  .flicks__content {
    @apply w-[calc(100%-80px)];
  }
  .flicks__video {
    @apply h-full w-full;
  }
  .flicks__info {
    @apply bottom-16 left-3 right-3;
  }
  .flicks__actions {
    @apply right-3 bottom-12;
  }
  .flicks__mute-button {
    @apply right-3;
  }
}

@media (min-width: 641px) {
  .flicks__container {
    @apply rounded-2xl shadow-lg;
  }
}

/* ==========================================================================
   High Contrast Mode Support
   ========================================================================== */
@media (prefers-contrast: high) {
  .flicks__action-button {
    @apply border border-[var(--border-color)];
  }
}